# InstallNugetPackage.yml
# 
# Description:
#   This template installs a NuGet package and moves it to a specified source folder.
#   It supports installing either the latest version or a specific version of a package.

parameters:
- name: packageName
  type: string
  default: ' '
- name: pkgVersion
  type: string
  default: ' '

steps:
- pwsh: |
    $bytes = [System.Text.Encoding]::UTF8.GetBytes("${{ parameters.pkgVersion }}")
    Write-Host ("ASCII: " + ($bytes -join ','))
    Write-Host ("Show: >${{ parameters.pkgVersion }}<")
    Write-Host "Length: ${{ length(parameters.pkgVersion) }}"
  displayName: "Debug Param Bytes"
- ${{ if eq(parameters.pkgVersion, ' ') }}:
  - pwsh: |
      Write-Host "1Installing latest version of package: ${{ parameters.packageName }}"
    displayName: '1Install NuGet Package - Latest Version'
    continueOnError: true
- ${{ else }}:
  - pwsh: |
      Write-Host "1Installing specific version of package: ${{ parameters.packageName }}. Version: '${{ parameters.pkgVersion }}'"
    displayName: '1Install NuGet Package - Specific Version'
    continueOnError: true
- ${{ if eq(parameters.pkgVersion, '$(VSEng_Mailer_Version)') }}:
  - pwsh: |
      Write-Host "2Installing latest version of package: ${{ parameters.packageName }}"
    displayName: '2Install NuGet Package - Latest Version'
    continueOnError: true
- ${{ else }}:
  - pwsh: |
      Write-Host "2Installing specific version of package: ${{ parameters.packageName }}. Version: '${{ parameters.pkgVersion }}'"
    displayName: '2Install NuGet Package - Specific Version'
    continueOnError: true